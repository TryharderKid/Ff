-- Whitelist system with random character insertion obfuscation
local function generateRandomInsertionWhitelist()
    -- Safe function caller
    local function safecall(func, ...)
        if type(func) == "function" then
            local success, result = pcall(func, ...)
            if success then return result end
        end
        return nil
    end
    
    -- Get HWID with multiple fallbacks
    local hwid = nil
    hwid = safecall(function() return getexecutorhwid() end)
    if not hwid then hwid = safecall(function() return gethwid() end) end
    if not hwid then hwid = safecall(function() return get_hwid() end) end
    if not hwid then hwid = safecall(function() return getexecutoridentifier() end) end
    if not hwid then hwid = "UNKNOWN_HWID" end
    
    -- Simple SHA256 hashing function (for HWID obfuscation)
    local function sha256(str)
        -- This is a simplified version for demonstration
        -- In a real implementation, use a proper SHA256 library
        local result = ""
        for i = 1, #str do
            local byte = string.byte(str, i)
            result = result .. string.format("%02x", byte)
        end
        -- Pad to make it look like a real SHA256 hash
        while #result < 64 do
            result = result .. "0"
        end
        return result:sub(1, 64)
    end
    
    -- Get user data
    local userId = game:GetService("Players").LocalPlayer.UserId
    
    -- Create a persistent ID
    local function getPersistentID()
        local HttpService = game:GetService("HttpService")
        local filename = "persistent_id.dat"
        
        local existingID = nil
        pcall(function()
            if readfile then existingID = readfile(filename) end
        end)
        
        if existingID and #existingID > 10 then
            return existingID
        end
        
        local newID = HttpService:GenerateGUID(false)
        pcall(function()
            if writefile then writefile(filename, newID) end
        end)
        
        return newID
    end
    
    local persistentID = getPersistentID()
    local placeID = game.PlaceId
    local clientID = game:GetService("RbxAnalyticsService"):GetClientId()
    
    -- Determine platform
    local UserInputService = game:GetService("UserInputService")
    local isPc = UserInputService.KeyboardEnabled and 500 or 0
    local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled and 1000 or 0
    
    -- Get player name
    local playerName = game:GetService("Players").LocalPlayer.Name
    
    -- Get executor name
    local executorName = "Unknown"
    pcall(function()
        if identifyexecutor then executorName = identifyexecutor() end
        if executorName == "Unknown" and getexecutorname then executorName = getexecutorname() end
    end)
    
    -- Simple obfuscation: hash the HWID
    local obfuscatedHWID = sha256(hwid)
    
    -- Random character insertion obfuscation
    local function obfuscateWithRandomChars(str)
        local result = ""
        local chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
        
        for i = 1, #str do
            local char = string.sub(str, i, i)
            -- Add the original character
            result = result .. char
            
            -- Add a random character after each original character
            if i < #str then
                local randomIndex = math.random(1, #chars)
                local randomChar = string.sub(chars, randomIndex, randomIndex)
                result = result .. randomChar
            end
        end
        
        return result
    end
    
    -- Format the whitelist string with random character insertion
    local components = {
        obfuscatedHWID,
        tostring(userId),
        tostring(persistentID),
        tostring(placeID),
        tostring(clientID),
        tostring(isPc),
        tostring(isMobile),
        playerName,
        executorName
    }
    
    -- Obfuscate each component
    for i = 1, #components do
        components[i] = obfuscateWithRandomChars(components[i])
    end
    
    -- Join with underscores
    local whitelistString = table.concat(components, "_")
    
    return whitelistString
end

-- Generate the whitelist string
local whitelistString = generateRandomInsertionWhitelist()

-- Print the result
print("Random Insertion Obfuscated Whitelist String:")
print(whitelistString)

-- Copy to clipboard
pcall(function()
    if setclipboard then
        setclipboard(whitelistString)
        print("Whitelist string copied to clipboard!")
    elseif writeclipboard then
        writeclipboard(whitelistString)
        print("Whitelist string copied to clipboard!")
    else
        print("Clipboard function not available. Please manually copy the string above.")
    end
end)

-- Return the string
return whitelistString
